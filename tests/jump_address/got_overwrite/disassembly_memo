[目的]
elf実行ファイルがprintf関数を初回呼び出し時の流れ、仕組みをgdb、readelf、objdumpを
使って追ってみる
STEP1. アプリケーションがPLT内のエントリを呼ぶ
STEP2. PLTはGOTに対応するエントリが示すアドレスにジャンプ
　　    初期状態では、PLTにリロケーション処理のアドレスが設定されている．
STEP3. PLTはリロケーションのための準備を行い，動的リンカにジャンプ
STEP4. 動的リンカはライブラリ関数のアドレスを解決し，GOTのエントリに上書き
STEP5. ライブラリ関数へジャンプ





[2] readelfで「.got.plt」、「.dynamic」の中身を見てみる
[2.1] readelfとは
ELF(Executable and Linkable Formar)ファイルの情報を表示する
[2.2] .got.pltセクションを確認
-- 下記コマンドを実行 --
readelf -x .got.plt a.out

-- output --
セクション '.got.plt' の 十六進数ダンプ:
 備考: このセクションには再配置がありますが、このダンプには適用されていません。
  0x00004000 fc3e0000 00000000 00000000 36100000 .>..........6...
  0x00004010 46100000 56100000 66100000 76100000 F...V...f...v...

[2.3] .dynamicセクションを確認
-- 下記コマンドを実行 --
readelf -x .dynamic a.out

-- output --
セクション '.dynamic' の 十六進数ダンプ:
  0x00003efc 01000000 4d000000 0c000000 00100000 ....M...........
  0x00003f0c 0d000000 e8120000 19000000 f43e0000 .............>..
  0x00003f1c 1b000000 04000000 1a000000 f83e0000 .............>..
  0x00003f2c 1c000000 04000000 f5feff6f ec010000 ...........o....
  0x00003f3c 05000000 bc020000 06000000 0c020000 ................
  0x00003f4c 0a000000 b2000000 0b000000 10000000 ................
  0x00003f5c 15000000 00000000 03000000 00400000 .............@..
  0x00003f6c 02000000 28000000 14000000 11000000 ....(...........
  0x00003f7c 17000000 f4030000 11000000 b4030000 ................
  0x00003f8c 12000000 40000000 13000000 08000000 ....@...........
  0x00003f9c fbffff6f 00000008 feffff6f 84030000 ...o.......o....
  0x00003fac ffffff6f 01000000 f0ffff6f 6e030000 ...o.......on...
  0x00003fbc faffff6f 04000000 00000000 00000000 ...o............
  0x00003fcc 00000000 00000000 00000000 00000000 ................
  0x00003fdc 00000000 00000000 00000000 00000000 ................



[MEMO]
ebx = 0x56559000

gdb command
x : print memory value


[*] first step main
x 0x5655900c 
0x5655900c <printf@got.plt>:	0x56556036


<printf@got.plt>:	0xf7e14f70

linux-gate.so.1 (0xf7ef6000)
	libc.so.6 => /lib/i386-linux-gnu/libc.so.6 (0xf7ce1000)
	/lib/ld-linux.so.2 (0xf7ef8000)



再配置セクション '.rel.plt' at offset 0x3f4 contains 5 entries:
 オフセット 情報    型              シンボル値 シンボル名
0000400c  00000207 R_386_JUMP_SLOT   00000000   printf@GLIBC_2.0

オフセットが0000400cであり、.got.pltのオフセットは00004000なので、
.got.pltのスロットである

セクション '.got.plt' の 十六進数ダンプ:
 備考: このセクションには再配置がありますが、このダンプには適用されていません。
  0x00004000 fc3e0000 00000000 00000000 36100000 .>..........6...
  0x00004010 46100000 56100000 66100000 76100000 F...V...f...v...

















